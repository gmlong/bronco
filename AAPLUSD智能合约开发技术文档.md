# AAPLUSDT é”šå®šERC20ä»£å¸é¡¹ç›®ç»“æ„

**AAPL è‚¡ç¥¨é”šå®š ERC20 ä»£å¸ MyToken**åœ¨ **BNB æµ‹è¯•ç½‘**éƒ¨ç½²é¡¹ç›®çš„**åˆçº¦å¼€å‘æŠ€æœ¯æ–‡æ¡£**ä¸**é¡¹ç›®æ¶æ„è®¾è®¡æ–¹æ¡ˆ**
---

# ğŸ“˜ åˆçº¦å¼€å‘æŠ€æœ¯æ–‡æ¡£ï¼ˆTechnical Specificationï¼‰

## ğŸ¯ é¡¹ç›®ç›®æ ‡

å‘è¡Œä¸€ä¸ªé”šå®š AAPLUSDT è‚¡ç¥¨ä»·æ ¼çš„ ERC20 å¯å‡çº§ä»£å¸ MyTokenï¼ˆä¾‹å¦‚å‘½åä¸º AAPLUSDTï¼‰ï¼Œéƒ¨ç½²åœ¨ BNB æµ‹è¯•ç½‘ï¼Œå…·å¤‡åŸºæœ¬äº¤æ˜“èƒ½åŠ›ã€çµæ´»æƒé™æ§åˆ¶ã€å¯å‡çº§ç»“æ„ä»¥åŠä¸ Chainlink é›†æˆçš„å¤–éƒ¨ä»·æ ¼è·å–èƒ½åŠ›ã€‚

---

## ğŸ§± æŠ€æœ¯æ ˆ

| ç»„ä»¶    | æŠ€æœ¯ / å·¥å…·                                   |
| ----- | ----------------------------------------- |
| ä¸»é“¾    | BNB Chain Testnet                         |
| ç¼–ç¨‹è¯­è¨€  | Solidity ^0.8.20                          |
| åˆçº¦æ ‡å‡†  | ERC20ï¼ˆOpenZeppelinï¼‰                       |
| å‡çº§æ¨¡å¼  | ERC1967 + Transparent Proxyï¼ˆOpenZeppelinï¼‰ |
| å®‰å…¨æœºåˆ¶  | Pausableï¼ˆå¯æš‚åœï¼‰ã€Ownableã€AccessControl       |
| ä»·æ ¼é¢„è¨€æœº | Chainlink Price Feed for AAPL/USD         |
| ç®¡ç†æƒé™  | ProxyAdmin + Ownable                      |
| å·¥å…·é“¾   | Hardhatï¼ˆæ¨èï¼‰ï¼ŒRemix ä¹Ÿå¯è°ƒè¯•ä½¿ç”¨                  |

---

## ğŸ—ï¸ é¡¹ç›®æ¶æ„æ€»è§ˆ

```
aaplusdt-project/
â”œâ”€â”€ contracts/
â”‚   â”œâ”€â”€ AAPLToken.sol           // ä¸»é€»è¾‘åˆçº¦ï¼ˆERC20 + é»‘ç™½åå• + å­˜/å–åŠŸèƒ½ï¼‰
â”‚   â”œâ”€â”€ USDTVault.sol           // USDT ç™½åå•ææ¬¾åˆçº¦
â”‚   â”œâ”€â”€ AAPLProxy.sol          // ERC1967 ä»£ç†åˆçº¦
â”‚   â”œâ”€â”€ ProxyAdmin.sol          // å‡çº§æ§åˆ¶åˆçº¦
â”‚   â””â”€â”€ PriceFeed.sol           // Chainlink å–‚ä»·æ¨¡å—
â”œâ”€â”€ scripts/
â”‚   â”œâ”€â”€ deploy.js               // ä¸€é”®éƒ¨ç½²è„šæœ¬
â”‚   â””â”€â”€ upgrade.js              // åˆçº¦å‡çº§è„šæœ¬
â”œâ”€â”€ test/                       // å•å…ƒæµ‹è¯•
â”œâ”€â”€ hardhat.config.js
â””â”€â”€ README.md
```

---

## ğŸ§© åˆçº¦æ¨¡å—è¯´æ˜

### 1. `AAPLToken.sol` â€“ ä¸»é€»è¾‘åˆçº¦ï¼ˆå¯å‡çº§ï¼‰

* **ç»§æ‰¿è‡ªï¼š**

  * `ERC20Upgradeable`
  * `ERC20BurnableUpgradeable`
  * `ERC20PausableUpgradeable`
  * `OwnableUpgradeable`
  * `UUPSUpgradeable`

* **åŠŸèƒ½ç‚¹åŒ…å«ï¼š**

  * âœ… ERC20 æ ‡å‡†æ¥å£ï¼ˆtransferã€approveã€mintã€burnã€burnFromç­‰ï¼‰
  * âœ… å¯æš‚åœ/å–æ¶ˆæš‚åœ/æŸ¥çœ‹æš‚åœçŠ¶æ€åˆçº¦äº¤æ˜“ï¼ˆpause/unpause/pausedï¼‰
  * âœ… é»‘åå•æœºåˆ¶ï¼šé™åˆ¶è¢«åˆ—å…¥åœ°å€çš„è½¬è´¦ã€è´­ä¹°ã€èµå›ç­‰è¡Œä¸º
  * âœ… å­˜å…¥ï¼ˆdepositï¼‰å‡½æ•°ï¼šç”¨ USDT è´­ä¹° AAPLï¼Œè°ƒç”¨æ—¶è¯»å– Chainlink æœ€æ–°ä»·æ ¼ï¼ˆæˆåŠŸåˆ™åç«¯è°ƒç”¨mintå‡½æ•°ç»™åˆ°è´­ä¹°ç”¨æˆ·ï¼‰
  * âœ… èµå›ï¼ˆredeemï¼‰å‡½æ•°ï¼šç”¨ AAPL èµå› USDTï¼ˆæˆåŠŸåˆ™åç«¯è°ƒç”¨withdrawUSDTå‡½æ•°å°†USDTå‘é€ç»™èµå›ç”¨æˆ·ï¼‰
  * âœ… emit `Deposit(address, uint256)`ã€`Redeem(address, uint256)` äº‹ä»¶
  * è®¢å•é•¿æ—¶é—´æœªæˆäº¤ï¼Œéœ€è¦è°ƒç”¨updateOrderStatuså‡½æ•°ï¼Œå°†è®¢å•çŠ¶æ€æ›´æ–°åˆ°åŒºå—é“¾ï¼Œemit OrderStatusUpdated(string txHash, string status);

  * âœ… å¯å‡çº§æ€§é€šè¿‡ `UUPSUpgradeable` å®ç°

---

### 2. `PriceFeed.sol` â€“ Chainlink ä»·æ ¼é¢„è¨€æœºæ¨¡å—

* é€šè¿‡ Chainlink Aggregator æ¥å£è¯»å–æœ€æ–°çš„ AAPL/USD ä»·æ ¼
* ç¤ºä¾‹æ¥å£ï¼š`AggregatorV3Interface public priceFeed;`
* å‡½æ•°ï¼š`getLatestPrice() returns (int256)`

---

### 3. `USDTVault.sol` â€“ ç®¡ç† USDT æç°çš„ç™½åå•åˆçº¦

* å¯ç”±ä¸»åˆçº¦è°ƒç”¨ï¼Œå¦‚ `redeem` æ—¶è§¦å‘
* ç®¡ç†å‘˜å¯ä»è¯¥ Vault ä¸­æå– USDT åˆ°ç™½åå•åœ°å€ï¼Œä½œè¿è¥ä½¿ç”¨
* ç®¡ç†å‘˜å¯åŠ¨æ€æ·»åŠ /ç§»é™¤ç™½åå•åœ°å€

| å‡½æ•°å                                             | åŠŸèƒ½è¯´æ˜                  |
| ----------------------------------------------- | --------------------- |
| `initialize(address _usdt)`                     | åˆå§‹åŒ–å‡½æ•°                 |
| `addToWhitelist(address account)`               | æ·»åŠ ç™½åå•åœ°å€ï¼ˆä»… ownerï¼‰      |
| `removeFromWhitelist(address account)`          | ç§»é™¤ç™½åå•åœ°å€               |
| `isWhitelisted(address account) returns (bool)` | æŸ¥è¯¢åœ°å€æ˜¯å¦åœ¨ç™½åå•ä¸­           |
| `depositUSDT(address from, uint256 amount)`     | ä»ä¸»åˆçº¦è½¬å…¥ USDT           |
| `withdrawUSDT(address to, uint256 amount)`      | ç”¨æˆ·èµå› USDT          |
| `getVaultBalance() returns (uint256)`           | æŸ¥è¯¢ Vault ä¸­ USDT ä½™é¢    |

---

### 4. `AAPLProxy.sol` + `ProxyAdmin.sol` â€“ å¯å‡çº§éƒ¨ç½²æ¨¡å—

* éµå¾ª ERC1967 æ ‡å‡†ç»“æ„
* æ‰€æœ‰ç”¨æˆ·ä¸ `AAPLProxy` äº¤äº’ï¼Œå®é™…é€»è¾‘åœ¨ `AAPLToken`
* `ProxyAdmin` åˆçº¦è´Ÿè´£æœªæ¥çš„å‡çº§æ§åˆ¶ï¼ˆé€šè¿‡ `upgradeTo`ï¼‰

---

## ğŸ” æƒé™æ§åˆ¶è®¾è®¡

| æƒé™è§’è‰²            | æƒé™                         |
| --------------- | -------------------------- |
| `owner` ï¼ˆåˆçº¦éƒ¨ç½²è€…ï¼‰ | å¯ä»¥æš‚åœ/å–æ¶ˆæš‚åœï¼Œè®¾ç½®ç™½åå•ã€é»‘åå•ï¼Œå‡çº§é€»è¾‘åˆçº¦ |
| `USDTæç°ç™½åå•åœ°å€`     | ownerå¯ä»¥æç°USDTåˆ°ç™½åå•           |
| `é»‘åå•åœ°å€`         | æ— æ³•æ‰§è¡Œä»»ä½•ä»£å¸äº¤äº’                 |

---

## âš™ï¸ å·¥ä½œæµç¨‹ï¼ˆå«ä»·æ ¼é”šå®šé€»è¾‘ï¼‰

### ğŸ“¥ è´­ä¹°ï¼ˆDepositï¼‰

1. ç”¨æˆ·å‘åˆçº¦è°ƒç”¨ `deposit(uint256 usdtAmount)`
2. åˆçº¦è¯»å– Chainlink çš„ `AAPL/USD` ä»·æ ¼
3. è®¡ç®—ç”¨æˆ·å¯è·å¾—å¤šå°‘ AAPLï¼ˆæŒ‰å®æ—¶ä»·æ ¼å…‘æ¢ç‡ï¼‰
4. å°†ç”¨æˆ· USDT è½¬å…¥ `USDTVault` ä¸­
5. emit `Deposit(address indexed user, uint256 amount)`
6. åç«¯è·å–æ—¥å¿—ï¼Œç„¶åè°ƒç”¨ mint ç›¸åº”çš„ AAPL ä»£å¸ç»™ç”¨æˆ·


### ğŸ“¤ èµå›ï¼ˆRedeemï¼‰

1. ç”¨æˆ·è°ƒç”¨ `redeem(uint256 aaplAmount)`
2. åˆçº¦æ ¹æ®å½“å‰ä»·æ ¼æ¢ç®—å‡ºåº”è¿”å› USDT æ•°é‡
3. æ£€æŸ¥ç”¨æˆ·æ˜¯å¦åœ¨ç™½åå•ä¸­
4. burn æ‰ç”¨æˆ·çš„ AAPL ä»£å¸
5. emit `Redeem(address indexed user, uint256 amount)`
6. åç«¯è·å–æ—¥å¿—ï¼Œç„¶åè°ƒç”¨USDTVaultåˆçº¦withdrawUSDTå‡½æ•°ï¼Œå°†å¯¹åº”æ•°é‡çš„ USDT è¿”å›ç”¨æˆ·

---

## ğŸ§ª æµ‹è¯•å»ºè®®

* âœ… æ­£å¸¸ç”¨æˆ·è´­ä¹°æµç¨‹
* âœ… æ­£å¸¸ç”¨æˆ·èµå›æµç¨‹ï¼ˆç™½åå•ï¼‰
* âœ… éç™½åå•åœ°å€å°è¯•èµå›åº”å¤±è´¥
* âœ… é»‘åå•åœ°å€äº¤äº’åº” revert
* âœ… Chainlink ä»·æ ¼æ›´æ–°æ­£ç¡®æ€§
* âœ… å‡çº§å‰ååŠŸèƒ½ä¿æŒç¨³å®šæ€§
* âœ… pause/unpause æµ‹è¯•æ˜¯å¦æˆåŠŸé˜»æ–­äº¤æ˜“

---

## ğŸ“ˆ æ‰©å±•å»ºè®®ï¼ˆæœªæ¥ï¼‰

* âœ… æ·»åŠ  AAPL æ¯è‚¡é”šå®šæ¯”ä¾‹ï¼ˆæ¯”å¦‚1:10å€ç¼©æ”¾ï¼‰
* âœ… æ”¯æŒå¤šç§è‚¡ç¥¨é”šå®šæ‰©å±•
* âœ… å‰ç«¯é›†æˆ Chainlink å®æ—¶ä»·æ ¼æ˜¾ç¤º
* âœ… å¤šç­¾è¿›è¡Œ ProxyAdmin çš„æ§åˆ¶è½¬ç§»
* âœ… å®ç° gas ä¼˜åŒ–ç‰ˆæœ¬çš„å–‚ä»·æ¨¡å—

---

